2023-08-01 01:57:06,452 [INFO] Parsed args: {
  "net": "vgg19_qlora",
  "weights": "checkpoint/vgg19_qlora/weights/vgg19_qlora-72-best.pth",
  "gpu": true,
  "b": 16,
  "log": "./logs/test_{datetime}.log"
}
2023-08-01 01:57:06,672 [INFO] VGGQLORA(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (7): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (8): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ReLU(inplace=True)
    (10): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): ReLU(inplace=True)
    (13): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (15): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): ReLU(inplace=True)
    (17): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (18): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): ReLU(inplace=True)
    (20): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (21): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (22): ReLU(inplace=True)
    (23): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (24): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (25): ReLU(inplace=True)
    (26): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (27): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (28): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (29): ReLU(inplace=True)
    (30): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (31): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): ReLU(inplace=True)
    (33): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (34): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (35): ReLU(inplace=True)
    (36): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (37): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (38): ReLU(inplace=True)
    (39): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (40): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (41): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (42): ReLU(inplace=True)
    (43): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (44): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (45): ReLU(inplace=True)
    (46): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (47): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (48): ReLU(inplace=True)
    (49): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (50): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (51): ReLU(inplace=True)
    (52): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (quant): QuantStub()
  (classifier): Sequential(
    (0): Linear(in_features=512, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.5, inplace=False)
    (3): Linear(in_features=4096, out_features=4096, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.5, inplace=False)
    (6): Linear(in_features=4096, out_features=100, bias=True)
  )
  (dequant): DeQuantStub()
)
2023-08-01 01:57:06,674 [INFO] 

2023-08-01 01:57:18,402 [INFO] Average throughput: 1458.1225934412148
2023-08-01 01:57:18,404 [INFO] Average inference time: 0.010955457429885863
2023-08-01 01:57:18,404 [INFO] GPU INFO.....

2023-08-01 01:57:18,408 [INFO] 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 164772 KiB | 314164 KiB | 252635 MiB | 252474 MiB |
|       from large pool | 161280 KiB | 307584 KiB | 238979 MiB | 238822 MiB |
|       from small pool |   3492 KiB |   6580 KiB |  13655 MiB |  13652 MiB |
|---------------------------------------------------------------------------|
| Active memory         | 164772 KiB | 314164 KiB | 252635 MiB | 252474 MiB |
|       from large pool | 161280 KiB | 307584 KiB | 238979 MiB | 238822 MiB |
|       from small pool |   3492 KiB |   6580 KiB |  13655 MiB |  13652 MiB |
|---------------------------------------------------------------------------|
| Requested memory      | 164310 KiB | 311582 KiB | 252045 MiB | 251884 MiB |
|       from large pool | 160832 KiB | 305024 KiB | 238391 MiB | 238234 MiB |
|       from small pool |   3478 KiB |   6558 KiB |  13653 MiB |  13650 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 344064 KiB | 344064 KiB | 344064 KiB |      0 B   |
|       from large pool | 335872 KiB | 335872 KiB | 335872 KiB |      0 B   |
|       from small pool |   8192 KiB |   8192 KiB |   8192 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  27740 KiB |  55900 KiB | 177700 MiB | 177673 MiB |
|       from large pool |  27136 KiB |  53504 KiB | 158574 MiB | 158547 MiB |
|       from small pool |    604 KiB |   3353 KiB |  19126 MiB |  19125 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     133    |     248    |   50876    |   50743    |
|       from large pool |      16    |      30    |   14406    |   14390    |
|       from small pool |     117    |     218    |   36470    |   36353    |
|---------------------------------------------------------------------------|
| Active allocs         |     133    |     248    |   50876    |   50743    |
|       from large pool |      16    |      30    |   14406    |   14390    |
|       from small pool |     117    |     218    |   36470    |   36353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      16    |      16    |      16    |       0    |
|       from large pool |      12    |      12    |      12    |       0    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      16    |   33484    |   33475    |
|       from large pool |       5    |       9    |   10022    |   10017    |
|       from small pool |       4    |       7    |   23462    |   23458    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

2023-08-01 01:57:18,408 [INFO] 

2023-08-01 01:57:18,412 [INFO] Top 1 err: 0.2882000207901001

2023-08-01 01:57:18,416 [INFO] Top 5 err: 0.12200003862380981

2023-08-01 01:57:18,417 [INFO] Parameter numbers: 39871524
