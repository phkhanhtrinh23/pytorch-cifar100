2023-08-01 03:34:44,424 [INFO] Parsed args: {
  "net": "vgg19_qlora",
  "weights": "checkpoint/vgg19_qlora/weights_r_8/vgg19_qlora-31-best.pth",
  "gpu": true,
  "b": 16,
  "log": "./logs/test_{datetime}.log"
}
2023-08-01 03:34:44,670 [INFO] VGGQLORA(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (7): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (8): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ReLU(inplace=True)
    (10): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): ReLU(inplace=True)
    (13): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (15): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): ReLU(inplace=True)
    (17): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (18): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): ReLU(inplace=True)
    (20): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (21): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (22): ReLU(inplace=True)
    (23): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (24): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (25): ReLU(inplace=True)
    (26): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (27): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (28): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (29): ReLU(inplace=True)
    (30): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (31): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): ReLU(inplace=True)
    (33): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (34): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (35): ReLU(inplace=True)
    (36): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (37): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (38): ReLU(inplace=True)
    (39): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (40): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (41): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (42): ReLU(inplace=True)
    (43): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (44): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (45): ReLU(inplace=True)
    (46): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (47): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (48): ReLU(inplace=True)
    (49): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (50): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (51): ReLU(inplace=True)
    (52): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (quant): QuantStub()
  (classifier): Sequential(
    (0): Linear(in_features=512, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.5, inplace=False)
    (3): Linear(in_features=4096, out_features=4096, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.5, inplace=False)
    (6): Linear(in_features=4096, out_features=100, bias=True)
  )
  (dequant): DeQuantStub()
)
2023-08-01 03:34:44,671 [INFO] 

2023-08-01 03:34:56,223 [INFO] Average throughput: 1329.7352393108458
2023-08-01 03:34:56,225 [INFO] Average inference time: 0.012013218517303468
2023-08-01 03:34:56,225 [INFO] GPU INFO.....

2023-08-01 03:34:56,226 [INFO] 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 163179 KiB | 310978 KiB | 252629 MiB | 252470 MiB |
|       from large pool | 161280 KiB | 307584 KiB | 238979 MiB | 238822 MiB |
|       from small pool |   1899 KiB |   3947 KiB |  13649 MiB |  13648 MiB |
|---------------------------------------------------------------------------|
| Active memory         | 163179 KiB | 310978 KiB | 252629 MiB | 252470 MiB |
|       from large pool | 161280 KiB | 307584 KiB | 238979 MiB | 238822 MiB |
|       from small pool |   1899 KiB |   3947 KiB |  13649 MiB |  13648 MiB |
|---------------------------------------------------------------------------|
| Requested memory      | 162717 KiB | 308395 KiB | 252039 MiB | 251880 MiB |
|       from large pool | 160832 KiB | 305024 KiB | 238391 MiB | 238234 MiB |
|       from small pool |   1885 KiB |   3933 KiB |  13647 MiB |  13645 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 342016 KiB | 342016 KiB | 342016 KiB |      0 B   |
|       from large pool | 335872 KiB | 335872 KiB | 335872 KiB |      0 B   |
|       from small pool |   6144 KiB |   6144 KiB |   6144 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  27285 KiB |  55445 KiB | 179197 MiB | 179170 MiB |
|       from large pool |  27136 KiB |  53504 KiB | 158574 MiB | 158547 MiB |
|       from small pool |    149 KiB |   2267 KiB |  20623 MiB |  20623 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     133    |     248    |   50876    |   50743    |
|       from large pool |      16    |      30    |   14406    |   14390    |
|       from small pool |     117    |     218    |   36470    |   36353    |
|---------------------------------------------------------------------------|
| Active allocs         |     133    |     248    |   50876    |   50743    |
|       from large pool |      16    |      30    |   14406    |   14390    |
|       from small pool |     117    |     218    |   36470    |   36353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      15    |      15    |      15    |       0    |
|       from large pool |      12    |      12    |      12    |       0    |
|       from small pool |       3    |       3    |       3    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      13    |   28936    |   28926    |
|       from large pool |       5    |       9    |   10022    |   10017    |
|       from small pool |       5    |       7    |   18914    |   18909    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

2023-08-01 03:34:56,226 [INFO] 

2023-08-01 03:34:56,227 [INFO] Top 1 err: 0.2883000373840332

2023-08-01 03:34:56,227 [INFO] Top 5 err: 0.12240004539489746

2023-08-01 03:34:56,228 [INFO] Parameter numbers: 39463620
