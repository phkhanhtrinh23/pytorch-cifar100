2023-08-01 06:33:24,563 [INFO] Parsed args: {
  "net": "vgg19_qlora",
  "weights": "checkpoint/vgg19_qlora/weights_r_32/vgg19_qlora-3-best.pth",
  "gpu": true,
  "b": 16,
  "log": "./logs/test_{datetime}.log"
}
2023-08-01 06:33:24,732 [INFO] Sequential(
  (0): tofp16()
  (1): VGGQLORA(
    (features): Sequential(
      (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (5): ReLU(inplace=True)
      (6): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (7): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (8): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (9): ReLU(inplace=True)
      (10): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (11): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (12): ReLU(inplace=True)
      (13): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (14): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (15): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (16): ReLU(inplace=True)
      (17): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (18): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (19): ReLU(inplace=True)
      (20): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (21): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (22): ReLU(inplace=True)
      (23): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (24): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (25): ReLU(inplace=True)
      (26): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (27): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (28): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (29): ReLU(inplace=True)
      (30): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (31): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (32): ReLU(inplace=True)
      (33): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (34): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (35): ReLU(inplace=True)
      (36): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (37): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (38): ReLU(inplace=True)
      (39): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (40): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (41): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (42): ReLU(inplace=True)
      (43): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (44): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (45): ReLU(inplace=True)
      (46): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (47): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (48): ReLU(inplace=True)
      (49): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (50): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (51): ReLU(inplace=True)
      (52): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    )
    (quant): QuantStub()
    (classifier): Sequential(
      (0): Linear(in_features=512, out_features=4096, bias=True)
      (1): ReLU(inplace=True)
      (2): Dropout(p=0.5, inplace=False)
      (3): Linear(in_features=4096, out_features=4096, bias=True)
      (4): ReLU(inplace=True)
      (5): Dropout(p=0.5, inplace=False)
      (6): Linear(in_features=4096, out_features=100, bias=True)
    )
    (dequant): DeQuantStub()
  )
)
2023-08-01 06:33:24,735 [INFO] 

2023-08-01 06:33:34,561 [INFO] Average throughput: 1408.2774456313875
2023-08-01 06:33:34,563 [INFO] Average inference time: 0.011343219370269775
2023-08-01 06:33:34,563 [INFO] GPU INFO.....

2023-08-01 06:33:34,564 [INFO] 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  89925 KiB | 236888 KiB |  76030 MiB |  75942 MiB |
|       from large pool |  86656 KiB | 230528 KiB |  64710 MiB |  64625 MiB |
|       from small pool |   3269 KiB |   6360 KiB |  11319 MiB |  11316 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  89925 KiB | 236888 KiB |  76030 MiB |  75942 MiB |
|       from large pool |  86656 KiB | 230528 KiB |  64710 MiB |  64625 MiB |
|       from small pool |   3269 KiB |   6360 KiB |  11319 MiB |  11316 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  86455 KiB | 233729 KiB |  76018 MiB |  75934 MiB |
|       from large pool |  83200 KiB | 227392 KiB |  64701 MiB |  64620 MiB |
|       from small pool |   3255 KiB |   6337 KiB |  11317 MiB |  11314 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 249856 KiB | 249856 KiB |      0 B   |
|       from large pool | 241664 KiB | 241664 KiB | 241664 KiB |      0 B   |
|       from small pool |   8192 KiB |   8192 KiB |   8192 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30906 KiB |  58531 KiB |  53223 MiB |  53193 MiB |
|       from large pool |  28032 KiB |  55680 KiB |  41629 MiB |  41602 MiB |
|       from small pool |   2874 KiB |   3839 KiB |  11594 MiB |  11591 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     133    |     248    |   51048    |   50915    |
|       from large pool |      14    |      28    |   11917    |   11903    |
|       from small pool |     119    |     220    |   39131    |   39012    |
|---------------------------------------------------------------------------|
| Active allocs         |     133    |     248    |   51048    |   50915    |
|       from large pool |      14    |      28    |   11917    |   11903    |
|       from small pool |     119    |     220    |   39131    |   39012    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       9    |       9    |       9    |       0    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |      26    |   21024    |   21004    |
|       from large pool |       2    |       7    |    3768    |    3766    |
|       from small pool |      18    |      23    |   17256    |   17238    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

2023-08-01 06:33:34,565 [INFO] 

2023-08-01 06:33:34,565 [INFO] Top 1 err: 0.9900000095367432

2023-08-01 06:33:34,566 [INFO] Top 5 err: 0.949999988079071

2023-08-01 06:33:34,566 [INFO] Parameter numbers: 39871524
