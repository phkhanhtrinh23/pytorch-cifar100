2023-08-01 01:34:21,603 [INFO] Parsed args: {
  "net": "vgg19_lora",
  "weights": "checkpoint/vgg19_lora/weights/vgg19_lora-175-best.pth",
  "gpu": true,
  "b": 16,
  "log": "./logs/test_{datetime}.log"
}
2023-08-01 01:34:21,672 [INFO] VGGLORA(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (7): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (8): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ReLU(inplace=True)
    (10): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): ReLU(inplace=True)
    (13): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (15): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): ReLU(inplace=True)
    (17): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (18): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): ReLU(inplace=True)
    (20): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (21): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (22): ReLU(inplace=True)
    (23): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (24): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (25): ReLU(inplace=True)
    (26): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (27): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (28): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (29): ReLU(inplace=True)
    (30): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (31): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): ReLU(inplace=True)
    (33): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (34): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (35): ReLU(inplace=True)
    (36): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (37): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (38): ReLU(inplace=True)
    (39): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (40): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (41): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (42): ReLU(inplace=True)
    (43): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (44): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (45): ReLU(inplace=True)
    (46): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (47): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (48): ReLU(inplace=True)
    (49): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (50): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (51): ReLU(inplace=True)
    (52): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (classifier): Sequential(
    (0): Linear(in_features=512, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.5, inplace=False)
    (3): Linear(in_features=4096, out_features=4096, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.5, inplace=False)
    (6): Linear(in_features=4096, out_features=100, bias=True)
  )
)
2023-08-01 01:34:21,673 [INFO] 

2023-08-01 01:34:35,724 [INFO] Average throughput: 1161.935813143864
2023-08-01 01:34:35,726 [INFO] Average inference time: 0.013748091606521604
2023-08-01 01:34:35,726 [INFO] GPU INFO.....

2023-08-01 01:34:35,728 [INFO] 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 164772 KiB | 204964 KiB | 252288 MiB | 252127 MiB |
|       from large pool | 161280 KiB | 200448 KiB | 238633 MiB | 238476 MiB |
|       from small pool |   3492 KiB |   5540 KiB |  13654 MiB |  13651 MiB |
|---------------------------------------------------------------------------|
| Active memory         | 164772 KiB | 204964 KiB | 252288 MiB | 252127 MiB |
|       from large pool | 161280 KiB | 200448 KiB | 238633 MiB | 238476 MiB |
|       from small pool |   3492 KiB |   5540 KiB |  13654 MiB |  13651 MiB |
|---------------------------------------------------------------------------|
| Requested memory      | 164310 KiB | 204502 KiB | 251895 MiB | 251734 MiB |
|       from large pool | 160832 KiB | 200000 KiB | 238243 MiB | 238085 MiB |
|       from small pool |   3478 KiB |   5526 KiB |  13652 MiB |  13648 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB | 235520 KiB | 235520 KiB |      0 B   |
|       from large pool | 229376 KiB | 229376 KiB | 229376 KiB |      0 B   |
|       from small pool |   6144 KiB |   6144 KiB |   6144 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  27740 KiB |  54876 KiB | 122702 MiB | 122675 MiB |
|       from large pool |  27136 KiB |  54272 KiB | 103578 MiB | 103552 MiB |
|       from small pool |    604 KiB |   2533 KiB |  19124 MiB |  19123 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     133    |     138    |   50758    |   50625    |
|       from large pool |      16    |      19    |   14391    |   14375    |
|       from small pool |     117    |     122    |   36367    |   36250    |
|---------------------------------------------------------------------------|
| Active allocs         |     133    |     138    |   50758    |   50625    |
|       from large pool |      16    |      19    |   14391    |   14375    |
|       from small pool |     117    |     122    |   36367    |   36250    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      11    |      11    |      11    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       3    |       3    |       3    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      13    |   34094    |   34085    |
|       from large pool |       5    |       6    |   10634    |   10629    |
|       from small pool |       4    |       7    |   23460    |   23456    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

2023-08-01 01:34:35,728 [INFO] 

2023-08-01 01:34:35,730 [INFO] Top 1 err: 0.9900000095367432

2023-08-01 01:34:35,732 [INFO] Top 5 err: 0.949999988079071

2023-08-01 01:34:35,733 [INFO] Parameter numbers: 39871524
